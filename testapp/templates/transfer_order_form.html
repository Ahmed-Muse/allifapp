{% extends 'base.html' %}
{% block title %}Create Transfer Order{% endblock %}

{% block content %}
<h2>Create Transfer Order ({{ current_company.name }})</h2>

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<form method="post">
    {% csrf_token %}
    <h3>Order Details</h3>
    {{ form.as_p }}

    <h3>Items to Transfer</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Product</th>
                <th>Quantity</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            {{ formset.management_form }}
            {% for item_form in formset %}
            <tr class="formset-row">
                <td>{{ item_form.product }}</td>
                <td>{{ item_form.quantity }}</td>
                <td>{{ item_form.DELETE }}</td>
                {{ item_form.id }} {# Hidden ID for existing items in formset #}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <button type="submit" class="btn btn-primary">Save Transfer Order</button>
</form>

<script>
    // JavaScript to add new rows dynamically for the formset (similar to previous examples)
    // You'd need to implement this for a good UX. Libraries like django-dynamic-formset can help.
</script>
{% endblock %}